<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>estimate CBH for a single tree using LadderFuelsR package — ladderfuelsr_cbh • cloud2trees</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="estimate CBH for a single tree using LadderFuelsR package — ladderfuelsr_cbh"><meta name="description" content='ladderfuelsr_cbh() is an all-in-one function to process height normalized .las|.laz files
using the functionality of the LadderFuelsR package.
The function returns a a list of data.frame objects that are the results of the different LadderFuelsR steps. Returns NULL if the process is unable to detect a CBH from the point cloud.
ladderfuelsr_cbh() outputs:
The order of operations is:
Create a data frame of the 3D voxels information (xyz) with Leaf Area Density (LAD) values from las file using leafR::lad.voxels()
Calculate the lad profile from the input lad.voxels using leafR::lad.profile()
Calculate gaps and fuel layers base height (FBH) as the difference in percentiles between consecutive LAD values along the vertical tree profile (VTP) using LadderFuelsR::get_gaps_fbhs()
Calculate the percentile value of each fuel layer base height using LadderFuelsR::calculate_gaps_perc()
Calculate distances (and their heights) between fuel layers as the difference between consecutive gaps and fuel bases using LadderFuelsR::get_distance()
Calculate fuels depth as the difference between gaps interleaved between fuel layers minus one step if the fuel depths are greater than one step using LadderFuelsR::get_depths()
Reshape fuel layers after removing distances equal to any number of height bin steps, keeping the first "base height" from those consecutive ones separated by such distance using LadderFuelsR::get_real_fbh()
Recalculate fuel layers depth after considering distances greater than the actual height bin step using LadderFuelsR::get_real_depths()
Recalculate the distance between fuel layers after considering distances greater than any number of height bin steps using LadderFuelsR::get_effective_gap()
Calculate the percentage of LAD within each fuel layer (first output) and removes those fuel layers with LAD percentage less than a specified threshold using LadderFuelsR::get_layers_lad()
Determine the CBH of a segmented tree using three criteria: maximum LAD percentage, maximum distance and the last distance using LadderFuelsR::get_cbh_metrics()

'><meta property="og:description" content='ladderfuelsr_cbh() is an all-in-one function to process height normalized .las|.laz files
using the functionality of the LadderFuelsR package.
The function returns a a list of data.frame objects that are the results of the different LadderFuelsR steps. Returns NULL if the process is unable to detect a CBH from the point cloud.
ladderfuelsr_cbh() outputs:
The order of operations is:
Create a data frame of the 3D voxels information (xyz) with Leaf Area Density (LAD) values from las file using leafR::lad.voxels()
Calculate the lad profile from the input lad.voxels using leafR::lad.profile()
Calculate gaps and fuel layers base height (FBH) as the difference in percentiles between consecutive LAD values along the vertical tree profile (VTP) using LadderFuelsR::get_gaps_fbhs()
Calculate the percentile value of each fuel layer base height using LadderFuelsR::calculate_gaps_perc()
Calculate distances (and their heights) between fuel layers as the difference between consecutive gaps and fuel bases using LadderFuelsR::get_distance()
Calculate fuels depth as the difference between gaps interleaved between fuel layers minus one step if the fuel depths are greater than one step using LadderFuelsR::get_depths()
Reshape fuel layers after removing distances equal to any number of height bin steps, keeping the first "base height" from those consecutive ones separated by such distance using LadderFuelsR::get_real_fbh()
Recalculate fuel layers depth after considering distances greater than the actual height bin step using LadderFuelsR::get_real_depths()
Recalculate the distance between fuel layers after considering distances greater than any number of height bin steps using LadderFuelsR::get_effective_gap()
Calculate the percentage of LAD within each fuel layer (first output) and removes those fuel layers with LAD percentage less than a specified threshold using LadderFuelsR::get_layers_lad()
Determine the CBH of a segmented tree using three criteria: maximum LAD percentage, maximum distance and the last distance using LadderFuelsR::get_cbh_metrics()

'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cloud2trees</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/cloud2trees-setup.html">Setup</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cloud2trees-overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/cloud2raster-tutorial.html">Creating DTM and CHM rasters</a></li>
    <li><a class="dropdown-item" href="../articles/raster2trees-tutorial.html">Generating a tree list from a CHM</a></li>
    <li><a class="dropdown-item" href="../articles/cloud2trees-pipeline.html">cloud2trees Pipeline</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/georgewoolsey/cloud2trees/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>estimate CBH for a <em>single tree</em> using <code>LadderFuelsR</code> package</h1>
      <small class="dont-index">Source: <a href="https://github.com/georgewoolsey/cloud2trees/blob/main/R/ladderfuelsr_cbh.R" class="external-link"><code>R/ladderfuelsr_cbh.R</code></a></small>
      <div class="d-none name"><code>ladderfuelsr_cbh.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>ladderfuelsr_cbh()</code> is an all-in-one function to process height normalized .las|.laz files
using the functionality of the <code>LadderFuelsR</code> package.
The function returns a a list of data.frame objects that are the results of the different LadderFuelsR steps. Returns NULL if the process is unable to detect a CBH from the point cloud.
<code>ladderfuelsr_cbh()</code> outputs:</p>
<p>The order of operations is:</p><ul><li><p>Create a data frame of the 3D voxels information (xyz) with Leaf Area Density (LAD) values from las file using <code><a href="https://rdrr.io/pkg/leafR/man/lad.voxels.html" class="external-link">leafR::lad.voxels()</a></code></p></li>
<li><p>Calculate the lad profile from the input lad.voxels using <code><a href="https://rdrr.io/pkg/leafR/man/lad.profile.html" class="external-link">leafR::lad.profile()</a></code></p></li>
<li><p>Calculate gaps and fuel layers base height (FBH) as the difference in percentiles between consecutive LAD values along the vertical tree profile (VTP) using <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_gaps_fbhs.html" class="external-link">LadderFuelsR::get_gaps_fbhs()</a></code></p></li>
<li><p>Calculate the percentile value of each fuel layer base height using <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/calculate_gaps_perc.html" class="external-link">LadderFuelsR::calculate_gaps_perc()</a></code></p></li>
<li><p>Calculate distances (and their heights) between fuel layers as the difference between consecutive gaps and fuel bases using <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_distance.html" class="external-link">LadderFuelsR::get_distance()</a></code></p></li>
<li><p>Calculate fuels depth as the difference between gaps interleaved between fuel layers minus one step if the fuel depths are greater than one step using <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_depths.html" class="external-link">LadderFuelsR::get_depths()</a></code></p></li>
<li><p>Reshape fuel layers after removing distances equal to any number of height bin steps, keeping the first "base height" from those consecutive ones separated by such distance using <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_real_fbh.html" class="external-link">LadderFuelsR::get_real_fbh()</a></code></p></li>
<li><p>Recalculate fuel layers depth after considering distances greater than the actual height bin step using <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_real_depths.html" class="external-link">LadderFuelsR::get_real_depths()</a></code></p></li>
<li><p>Recalculate the distance between fuel layers after considering distances greater than any number of height bin steps using <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_effective_gap.html" class="external-link">LadderFuelsR::get_effective_gap()</a></code></p></li>
<li><p>Calculate the percentage of LAD within each fuel layer (first output) and removes those fuel layers with LAD percentage less than a specified threshold using <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_layers_lad.html" class="external-link">LadderFuelsR::get_layers_lad()</a></code></p></li>
<li><p>Determine the CBH of a segmented tree using three criteria: maximum LAD percentage, maximum distance and the last distance using <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_cbh_metrics.html" class="external-link">LadderFuelsR::get_cbh_metrics()</a></code></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ladderfuelsr_cbh</span><span class="op">(</span></span>
<span>  lad_profile_df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  las <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  treeID <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min_vhp_n <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  voxel_grain_size_m <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dist_btwn_bins_m <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min_fuel_layer_ht_m <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lad_pct_gap <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  lad_pct_base <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  num_jump_steps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min_lad_pct <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  frst_layer_min_ht_m <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-lad-profile-df">lad_profile_df<a class="anchor" aria-label="anchor" href="#arg-lad-profile-df"></a></dt>
<dd><p>data.frame. the return of <code><a href="leafr_for_ladderfuelsr.html">leafr_for_ladderfuelsr()</a></code> or a data.frame
that must have the columns: treeID, lad, total_pulses, height.
if both the <code>lad_profile_df</code> and <code>las</code> parameters are defined, the preference is the data.frame</p></dd>


<dt id="arg-las">las<a class="anchor" aria-label="anchor" href="#arg-las"></a></dt>
<dd><p>string -or- object. a single tree .las|.laz file path -OR- an object of class LAS that has been height normalized.</p></dd>


<dt id="arg-treeid">treeID<a class="anchor" aria-label="anchor" href="#arg-treeid"></a></dt>
<dd><p>numeric. the LadderFuelsR process requires a treeID that uniquely identifies points within a tree
, if left as NA this process will attempt to locate the <code>treeID</code>
data based on an attribute in the point cloud or data.frame which should be numeric</p></dd>


<dt id="arg-min-vhp-n">min_vhp_n<a class="anchor" aria-label="anchor" href="#arg-min-vhp-n"></a></dt>
<dd><p>numeric. the minimum number of vertical height profiles (VHPs) needed to estimate a CBH.</p></dd>


<dt id="arg-voxel-grain-size-m">voxel_grain_size_m<a class="anchor" aria-label="anchor" href="#arg-voxel-grain-size-m"></a></dt>
<dd><p>numeric. only used if <code>las</code> parameter is defined.
horizontal resolution (suggested 1 meter for lad profiles).
See <code>grain.size</code> in <code><a href="https://rdrr.io/pkg/leafR/man/lad.voxels.html" class="external-link">leafR::lad.voxels()</a></code></p></dd>


<dt id="arg-dist-btwn-bins-m">dist_btwn_bins_m<a class="anchor" aria-label="anchor" href="#arg-dist-btwn-bins-m"></a></dt>
<dd><p>numeric. value for the actual height bin step (in meters). See <code>step</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_gaps_fbhs.html" class="external-link">LadderFuelsR::get_gaps_fbhs()</a></code></p></dd>


<dt id="arg-min-fuel-layer-ht-m">min_fuel_layer_ht_m<a class="anchor" aria-label="anchor" href="#arg-min-fuel-layer-ht-m"></a></dt>
<dd><p>numeric. value for the actual minimum base height (in meters). See <code>min_height</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_gaps_fbhs.html" class="external-link">LadderFuelsR::get_gaps_fbhs()</a></code></p></dd>


<dt id="arg-lad-pct-gap">lad_pct_gap<a class="anchor" aria-label="anchor" href="#arg-lad-pct-gap"></a></dt>
<dd><p>numeric. value of the percentile threshold used to identify gaps (default percentile 25th). See <code>perc_gap</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_gaps_fbhs.html" class="external-link">LadderFuelsR::get_gaps_fbhs()</a></code></p></dd>


<dt id="arg-lad-pct-base">lad_pct_base<a class="anchor" aria-label="anchor" href="#arg-lad-pct-base"></a></dt>
<dd><p>numeric. value of the percentile threshold used to identify fuels layers base height (default percentile 25th). See <code>perc_base</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_gaps_fbhs.html" class="external-link">LadderFuelsR::get_gaps_fbhs()</a></code></p></dd>


<dt id="arg-num-jump-steps">num_jump_steps<a class="anchor" aria-label="anchor" href="#arg-num-jump-steps"></a></dt>
<dd><p>numeric. value for the number of height bin steps that can be jumped to reshape fuels layers. See <code>number_steps</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_real_fbh.html" class="external-link">LadderFuelsR::get_real_fbh()</a></code></p></dd>


<dt id="arg-min-lad-pct">min_lad_pct<a class="anchor" aria-label="anchor" href="#arg-min-lad-pct"></a></dt>
<dd><p>numeric. value for the minimum required LAD percentage in a fuel layer. See <code>threshold</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_layers_lad.html" class="external-link">LadderFuelsR::get_layers_lad()</a></code></p></dd>


<dt id="arg-frst-layer-min-ht-m">frst_layer_min_ht_m<a class="anchor" aria-label="anchor" href="#arg-frst-layer-min-ht-m"></a></dt>
<dd><p>numeric. value for the depth height of the first fuel layer.
If the first fuel layer has the maximum LAD and its depth is greater than the indicated value
, then this fuel layer is considered as the CBH of the tree. On the contrary, if its depth is &lt;= the value, the CBH with maximum LAD will be the second fuel layer, although it has not the maximum LAD.
See <code>hdepth1_height</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_cbh_metrics.html" class="external-link">LadderFuelsR::get_cbh_metrics()</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an list of data.frame objects that are the results of the different LadderFuelsR steps. Returns NULL if the process is unable to detect a CBH from the point cloud.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p><a href="https://doi.org/10.1111/2041-210X.14427" class="external-link">https://doi.org/10.1111/2041-210X.14427</a>
Viedma, O., Silva, C. A., Moreno, J. M., &amp; Hudak, A. T. (2024). LadderFuelsR: A new automated tool for vertical fuel continuity analysis and crown base height detection using light detection and ranging. Methods in Ecology and Evolution.
<a href="https://github.com/olgaviedma/LadderFuelsR" class="external-link">https://github.com/olgaviedma/LadderFuelsR</a></p></li>
<li><p><a href="https://doi.org/10.3390/rs11010092" class="external-link">https://doi.org/10.3390/rs11010092</a>
Almeida, D. R. A. D., Stark, S. C., Shao, G., Schietti, J., Nelson, B. W., Silva, C. A., ... &amp; Brancalion, P. H. S. (2019). Optimizing the remote detection of tropical rainforest structure with airborne lidar: Leaf area profile sensitivity to pulse density and spatial sampling. Remote Sensing, 11(1), 92.
<a href="https://github.com/DRAAlmeida/leafR" class="external-link">https://github.com/DRAAlmeida/leafR</a></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span> <span class="co"># polygon data</span></span></span>
<span class="r-in"><span> <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"cloud2trees"</span>,<span class="st">"extdata"</span>,<span class="st">"crowns_poly.gpkg"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">trees_poly</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># simplify polygons</span></span></span>
<span class="r-in"><span> <span class="va">trees_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="simplify_multipolygon_crowns.html">simplify_multipolygon_crowns</a></span><span class="op">(</span><span class="va">trees_poly</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># point cloud data</span></span></span>
<span class="r-in"><span> <span class="va">lf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"cloud2trees"</span>,<span class="st">"extdata"</span>,<span class="st">"norm_las"</span>,<span class="st">"RMNP_017_2018_normalize.las"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">las</span> <span class="op">&lt;-</span> <span class="fu">lidR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lidR/man/readLAS.html" class="external-link">readLAS</a></span><span class="op">(</span><span class="va">lf</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">las</span><span class="op">@</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># polygon_attribute_to_las to attach treeID to las</span></span></span>
<span class="r-in"><span> <span class="va">las</span> <span class="op">&lt;-</span> <span class="fu"><a href="polygon_attribute_to_las.html">polygon_attribute_to_las</a></span><span class="op">(</span><span class="va">las</span>, <span class="va">trees_poly</span>, force_crs <span class="op">=</span> <span class="cn">T</span>, attribute <span class="op">=</span> <span class="st">"treeID"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">las</span><span class="op">@</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># get the lad profile for each treeID</span></span></span>
<span class="r-in"><span> <span class="va">lad_profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="leafr_for_ladderfuelsr.html">leafr_for_ladderfuelsr</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>     <span class="va">las</span></span></span>
<span class="r-in"><span>     , voxel_grain_size_m <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>     , k <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>     , group_treeID <span class="op">=</span> <span class="cn">T</span></span></span>
<span class="r-in"><span>     , relative <span class="op">=</span> <span class="cn">F</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">lad_profile</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># extract the CBH using ladderfuelsr_cbh()</span></span></span>
<span class="r-in"><span> <span class="co"># before we extract the CBH using ladderfuelsr_cbh(), treeID has to be numeric</span></span></span>
<span class="r-in"><span> <span class="va">lad_profile</span> <span class="op">&lt;-</span> <span class="va">lad_profile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>     treeID_backup <span class="op">=</span> <span class="va">treeID</span>, treeID <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">treeID</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># for one tree</span></span></span>
<span class="r-in"><span> <span class="fu">ladderfuelsr_cbh</span><span class="op">(</span></span></span>
<span class="r-in"><span>     lad_profile_df <span class="op">=</span> <span class="va">lad_profile</span></span></span>
<span class="r-in"><span>     , treeID <span class="op">=</span> <span class="va">lad_profile</span><span class="op">$</span><span class="va">treeID</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>   <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>   <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"cbh_metrics"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># we can map over multiple trees</span></span></span>
<span class="r-in"><span> <span class="va">cbhs</span> <span class="op">&lt;-</span> <span class="va">lad_profile</span><span class="op">$</span><span class="va">treeID</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>   <span class="va">.</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>   <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">ladderfuelsr_cbh</span><span class="op">(</span></span></span>
<span class="r-in"><span>       lad_profile_df <span class="op">=</span> <span class="va">lad_profile</span></span></span>
<span class="r-in"><span>       , treeID <span class="op">=</span> <span class="va">x</span></span></span>
<span class="r-in"><span>     <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>     <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"cbh_metrics"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">cbhs</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cbhs</span>, mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">last_Hcbh</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by George Woolsey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

