<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Use raw .las|.laz files to generate CHM, DTM, and a tree list — cloud2trees • cloud2trees</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use raw .las|.laz files to generate CHM, DTM, and a tree list — cloud2trees"><meta name="description" content="cloud2trees() is an all-in-one function to process raw .las|.laz files
to generate a CHM raster (.tif), a DTM raster (.tif), and a tree list with tree location, height, and DBH.
The order of operations is:
Generate a CHM from the point cloud using cloud2raster()
Perform individual tree detection using raster2trees()
Quantify individual tree competition metrics using trees_competition() (if set to TRUE)
Extract tree DBH values from the normalized point cloud using treels_stem_dbh() (if set to TRUE)
Model tree DBH values using trees_dbh() (if set to TRUE)
Extract tree forest type group using trees_type() (if set to TRUE)
Extract tree CBH values from the normalized point cloud and estimate missing values using trees_cbh() (if set to TRUE)
Estimate tree biomass (or crown biomass) using trees_biomass() (if method is denoted)


See the documentation for each individual function called for more details."><meta property="og:description" content="cloud2trees() is an all-in-one function to process raw .las|.laz files
to generate a CHM raster (.tif), a DTM raster (.tif), and a tree list with tree location, height, and DBH.
The order of operations is:
Generate a CHM from the point cloud using cloud2raster()
Perform individual tree detection using raster2trees()
Quantify individual tree competition metrics using trees_competition() (if set to TRUE)
Extract tree DBH values from the normalized point cloud using treels_stem_dbh() (if set to TRUE)
Model tree DBH values using trees_dbh() (if set to TRUE)
Extract tree forest type group using trees_type() (if set to TRUE)
Extract tree CBH values from the normalized point cloud and estimate missing values using trees_cbh() (if set to TRUE)
Estimate tree biomass (or crown biomass) using trees_biomass() (if method is denoted)


See the documentation for each individual function called for more details."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cloud2trees</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/cloud2trees-setup.html">Setup</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cloud2trees-overview.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/cloud2raster-tutorial.html">Creating DTM and CHM rasters</a></li>
    <li><a class="dropdown-item" href="../articles/raster2trees-tutorial.html">Generating a tree list from a CHM</a></li>
    <li><a class="dropdown-item" href="../articles/cloud2trees-pipeline.html">cloud2trees Pipeline</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/georgewoolsey/cloud2trees/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Use raw .las|.laz files to generate CHM, DTM, and a tree list</h1>
      <small class="dont-index">Source: <a href="https://github.com/georgewoolsey/cloud2trees/blob/main/R/cloud2trees.R" class="external-link"><code>R/cloud2trees.R</code></a></small>
      <div class="d-none name"><code>cloud2trees.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>cloud2trees()</code> is an all-in-one function to process raw .las|.laz files
to generate a CHM raster (.tif), a DTM raster (.tif), and a tree list with tree location, height, and DBH.
The order of operations is:</p><ul><li><p>Generate a CHM from the point cloud using <code><a href="cloud2raster.html">cloud2raster()</a></code></p></li>
<li><p>Perform individual tree detection using <code><a href="raster2trees.html">raster2trees()</a></code></p></li>
<li><p>Quantify individual tree competition metrics using <code><a href="trees_competition.html">trees_competition()</a></code> (<em>if set to TRUE</em>)</p></li>
<li><p>Extract tree DBH values from the normalized point cloud using <code><a href="treels_stem_dbh.html">treels_stem_dbh()</a></code> (<em>if set to TRUE</em>)</p></li>
<li><p>Model tree DBH values using <code><a href="trees_dbh.html">trees_dbh()</a></code> (<em>if set to TRUE</em>)</p></li>
<li><p>Extract tree forest type group using <code><a href="trees_type.html">trees_type()</a></code> (<em>if set to TRUE</em>)</p></li>
<li><p>Extract tree CBH values from the normalized point cloud and estimate missing values using <code><a href="trees_cbh.html">trees_cbh()</a></code> (<em>if set to TRUE</em>)</p></li>
<li><p>Estimate tree biomass (or crown biomass) using <code><a href="trees_biomass.html">trees_biomass()</a></code> (<em>if method is denoted</em>)</p></li>
</ul><p>See the documentation for each individual function called for more details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cloud2trees</span><span class="op">(</span></span>
<span>  <span class="va">output_dir</span>,</span>
<span>  <span class="va">input_las_dir</span>,</span>
<span>  input_treemap_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  input_foresttype_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  input_landfire_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  accuracy_level <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max_ctg_pts <span class="op">=</span> <span class="fl">7e+07</span>,</span>
<span>  max_area_m2 <span class="op">=</span> <span class="fl">9e+07</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  new_crs <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  old_crs <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  keep_intrmdt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dtm_res_m <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  chm_res_m <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  min_height <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max_height <span class="op">=</span> <span class="fl">70</span>,</span>
<span>  ws <span class="op">=</span> <span class="fu"><a href="itd_ws_functions.html">itd_ws_functions</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="st">"log_fn"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  estimate_tree_dbh <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_dbh <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  dbh_model_regional <span class="op">=</span> <span class="st">"cr"</span>,</span>
<span>  dbh_model_local <span class="op">=</span> <span class="st">"lin"</span>,</span>
<span>  estimate_dbh_from_cloud <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  estimate_tree_competition <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  competition_buffer_m <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  <span class="va">search_dist_max</span>,</span>
<span>  competition_max_search_dist_m <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  estimate_tree_type <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  type_max_search_dist_m <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  estimate_tree_hmd <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  hmd_tree_sample_n <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  hmd_tree_sample_prop <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  hmd_estimate_missing_hmd <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  estimate_biomass_method <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  biomass_max_crown_kg_per_m3 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  estimate_tree_cbh <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cbh_tree_sample_n <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  cbh_tree_sample_prop <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  cbh_which_cbh <span class="op">=</span> <span class="st">"lowest"</span>,</span>
<span>  cbh_estimate_missing_cbh <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cbh_min_vhp_n <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cbh_voxel_grain_size_m <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cbh_dist_btwn_bins_m <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cbh_min_fuel_layer_ht_m <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cbh_lad_pct_gap <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  cbh_lad_pct_base <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  cbh_num_jump_steps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cbh_min_lad_pct <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  cbh_frst_layer_min_ht_m <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-output-dir">output_dir<a class="anchor" aria-label="anchor" href="#arg-output-dir"></a></dt>
<dd><p>parent directory where new folders <code>point_cloud_processing_delivery</code> and <code>point_cloud_processing_temp</code> will be written for exports</p></dd>


<dt id="arg-input-las-dir">input_las_dir<a class="anchor" aria-label="anchor" href="#arg-input-las-dir"></a></dt>
<dd><p>directory where .las|.laz point cloud data exists...program will search all sub-directories for all .las|.laz files and process them as one</p></dd>


<dt id="arg-input-treemap-dir">input_treemap_dir<a class="anchor" aria-label="anchor" href="#arg-input-treemap-dir"></a></dt>
<dd><p>character. directory where Treemap 2016 exists. Use <code><a href="get_treemap.html">get_treemap()</a></code> first.</p></dd>


<dt id="arg-input-foresttype-dir">input_foresttype_dir<a class="anchor" aria-label="anchor" href="#arg-input-foresttype-dir"></a></dt>
<dd><p>character. directory where Forest Type Groups data exists. Use <code><a href="get_foresttype.html">get_foresttype()</a></code> first.</p></dd>


<dt id="arg-input-landfire-dir">input_landfire_dir<a class="anchor" aria-label="anchor" href="#arg-input-landfire-dir"></a></dt>
<dd><p>character. directory where LANDFIRE CBD data exists. Use <code><a href="get_landfire.html">get_landfire()</a></code> first.</p></dd>


<dt id="arg-accuracy-level">accuracy_level<a class="anchor" aria-label="anchor" href="#arg-accuracy-level"></a></dt>
<dd><p>numeric. Choose processing accuracy.
accuracy_level = 1 uses DTM to height normalize the points
accuracy_level = 2 uses triangulation with high point density (20 pts/m2) to height normalize the points
accuracy_level = 3 uses triangulation with very high point density (100 pts/m2) to height normalize the points</p></dd>


<dt id="arg-max-ctg-pts">max_ctg_pts<a class="anchor" aria-label="anchor" href="#arg-max-ctg-pts"></a></dt>
<dd><p>numeric. Max number of points to process at one time. Setting this number higher will possibly reduce run times but increase the chance of running out of memory and vice versa.</p></dd>


<dt id="arg-max-area-m-">max_area_m2<a class="anchor" aria-label="anchor" href="#arg-max-area-m-"></a></dt>
<dd><p>numeric. Max area to process at one time. See <code>max_ctg_pts</code> parameter, this one is less important as never experienced memory issues with large areas (just lots of points)</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>logical. should the las/laz files be transformed? If set to <code>TRUE</code> the parameters <code>new_crs</code> must be defined.</p></dd>


<dt id="arg-new-crs">new_crs<a class="anchor" aria-label="anchor" href="#arg-new-crs"></a></dt>
<dd><p>string. crs to change to as an epsg numerical code</p></dd>


<dt id="arg-old-crs">old_crs<a class="anchor" aria-label="anchor" href="#arg-old-crs"></a></dt>
<dd><p>string. crs to change from as an epsg numerical code</p></dd>


<dt id="arg-keep-intrmdt">keep_intrmdt<a class="anchor" aria-label="anchor" href="#arg-keep-intrmdt"></a></dt>
<dd><p>logical. this process writes intermediate data to the disk, keep those intermediate files (classfied, normalized, stem las files)?</p></dd>


<dt id="arg-dtm-res-m">dtm_res_m<a class="anchor" aria-label="anchor" href="#arg-dtm-res-m"></a></dt>
<dd><p>numeric. The desired resolution of the DTM produced in meters.</p></dd>


<dt id="arg-chm-res-m">chm_res_m<a class="anchor" aria-label="anchor" href="#arg-chm-res-m"></a></dt>
<dd><p>numeric. The desired resolution of the CHM produced in meters.</p></dd>


<dt id="arg-min-height">min_height<a class="anchor" aria-label="anchor" href="#arg-min-height"></a></dt>
<dd><p>numeric. Set the minimum height (m) for individual tree detection</p></dd>


<dt id="arg-max-height">max_height<a class="anchor" aria-label="anchor" href="#arg-max-height"></a></dt>
<dd><p>numeric. Set the maximum height (m) for the canopy height model</p></dd>


<dt id="arg-ws">ws<a class="anchor" aria-label="anchor" href="#arg-ws"></a></dt>
<dd><p>numeric or function. Length or diameter of the moving window used to detect the local
maxima in the units of the input data (usually meters). If it is numeric a fixed window size is used.
If it is a function, the function determines the size of the window at any given location on the canopy.
By default function takes the height of a given pixel as its only argument and return the
desired size of the search window when centered on that pixel.</p></dd>


<dt id="arg-estimate-tree-dbh">estimate_tree_dbh<a class="anchor" aria-label="anchor" href="#arg-estimate-tree-dbh"></a></dt>
<dd><p>logical. Should tree DBH be estimated? See <code><a href="trees_dbh.html">trees_dbh()</a></code>.</p></dd>


<dt id="arg-max-dbh">max_dbh<a class="anchor" aria-label="anchor" href="#arg-max-dbh"></a></dt>
<dd><p>numeric. Set the largest tree diameter (m) expected in the point cloud</p></dd>


<dt id="arg-dbh-model-regional">dbh_model_regional<a class="anchor" aria-label="anchor" href="#arg-dbh-model-regional"></a></dt>
<dd><p>string. Set the model to use for regional dbh-height allometry based on FIA tree measurements.
Can be "cr" for the Chapman-Richards formula (default) or "power" for power function</p></dd>


<dt id="arg-dbh-model-local">dbh_model_local<a class="anchor" aria-label="anchor" href="#arg-dbh-model-local"></a></dt>
<dd><p>string. Set the model to use for local dbh-height allometry based on provided DBH training data in <code>treels_dbh_locations</code>.
Can be "rf" for random forest or "lin" for linear</p></dd>


<dt id="arg-estimate-dbh-from-cloud">estimate_dbh_from_cloud<a class="anchor" aria-label="anchor" href="#arg-estimate-dbh-from-cloud"></a></dt>
<dd><p>logical. Should DBH be estimated from the point cloud? See <code><a href="treels_stem_dbh.html">treels_stem_dbh()</a></code>. Setting to <code>TRUE</code> may significantly increase processing time.</p></dd>


<dt id="arg-estimate-tree-competition">estimate_tree_competition<a class="anchor" aria-label="anchor" href="#arg-estimate-tree-competition"></a></dt>
<dd><p>logical. Should tree competition metrics be calculated? See <code><a href="trees_competition.html">trees_competition()</a></code>. Setting to <code>TRUE</code> may slightly increase processing time.</p></dd>


<dt id="arg-competition-buffer-m">competition_buffer_m<a class="anchor" aria-label="anchor" href="#arg-competition-buffer-m"></a></dt>
<dd><p>number. Set buffer around tree (m) to calculate competition metrics</p></dd>


<dt id="arg-search-dist-max">search_dist_max<a class="anchor" aria-label="anchor" href="#arg-search-dist-max"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Use the <code>competition_max_search_dist_m</code> argument instead.</p></dd>


<dt id="arg-competition-max-search-dist-m">competition_max_search_dist_m<a class="anchor" aria-label="anchor" href="#arg-competition-max-search-dist-m"></a></dt>
<dd><p>number. Maximum search distance (m) to nearest tree for competition. Larger search distances will increase processing time and possibly result in memory issues.
If no competition trees are found within this distance, the return column <code>comp_dist_to_nearest_m</code> = <code>competition_max_search_dist_m</code> parameter.</p></dd>


<dt id="arg-estimate-tree-type">estimate_tree_type<a class="anchor" aria-label="anchor" href="#arg-estimate-tree-type"></a></dt>
<dd><p>logical. Should tree forest type be estimated? See <code><a href="trees_type.html">trees_type()</a></code>.</p></dd>


<dt id="arg-type-max-search-dist-m">type_max_search_dist_m<a class="anchor" aria-label="anchor" href="#arg-type-max-search-dist-m"></a></dt>
<dd><p>number. Maximum search distance (m) to obtain forest type group data for trees that overlap with non-forest data in the original Wilson (2023) data.
Larger search distances will increase processing time and possibly result in memory issues.</p></dd>


<dt id="arg-estimate-tree-hmd">estimate_tree_hmd<a class="anchor" aria-label="anchor" href="#arg-estimate-tree-hmd"></a></dt>
<dd><p>logical. Should tree height of the maximum crown diameter (HMD) be estimated? See <code><a href="trees_hmd.html">trees_hmd()</a></code>.</p></dd>


<dt id="arg-hmd-tree-sample-n-hmd-tree-sample-prop">hmd_tree_sample_n, hmd_tree_sample_prop<a class="anchor" aria-label="anchor" href="#arg-hmd-tree-sample-n-hmd-tree-sample-prop"></a></dt>
<dd><p>numeric. Provide either <code>tree_sample_n</code>, the number of trees, or <code>tree_sample_prop</code>, the
proportion of the trees to attempt to extract a HMD from the point cloud for.
If neither are supplied, <code>tree_sample_n = 777</code> will be used. If both are supplied, <code>tree_sample_n</code> will be used.
Increasing <code>tree_sample_prop</code> toward one (1) will increase the processing time, perhaps significantly depending on the number of trees in the <code>trees_poly</code> data.
The maximum number of trees to extract tree HMD using <code>cloud2trees()</code> is 20,000.
Try <code><a href="trees_hmd.html">trees_hmd()</a></code> with outputs from <code>cloud2trees()</code> if you want to attempt to extract HMD for &gt;20,000 trees.</p></dd>


<dt id="arg-hmd-estimate-missing-hmd">hmd_estimate_missing_hmd<a class="anchor" aria-label="anchor" href="#arg-hmd-estimate-missing-hmd"></a></dt>
<dd><p>logical. It is not likely that HMD will be extracted successfully from every tree.
Should the missing HMD values be estimated using the tree height and location information based on trees for which HMD is successfully extracted?</p></dd>


<dt id="arg-estimate-biomass-method">estimate_biomass_method<a class="anchor" aria-label="anchor" href="#arg-estimate-biomass-method"></a></dt>
<dd><p>character. To estimate tree biomass or tree (or crown biomass) enter one or a list of multiple biomass methods. See <code><a href="trees_biomass.html">trees_biomass()</a></code>.
Leave as blank (i.e. <code>NA</code>) to skip biomass estimation.</p></dd>


<dt id="arg-biomass-max-crown-kg-per-m-">biomass_max_crown_kg_per_m3<a class="anchor" aria-label="anchor" href="#arg-biomass-max-crown-kg-per-m-"></a></dt>
<dd><p>numeric. the maximum CBD of the tree crown in kilograms per cubic meter.
Values above this limit will be set at the median value for the area using only stands that have CBD values lower than this limit.
The default value of 2 kilograms per cubic meter was based on <a href="https://doi.org/10.1016/j.combustflame.2009.06.015" class="external-link">Mell et al. (2009)</a>
who found the dry bulk density of the tree crown was 2.6 kilograms per cubed meter
using Douglas-fir trees grown on Christmas tree farms.
Set this parameter to a large value (e.g. 1e10) or NULL to avoid limiting tree crown CBD.</p></dd>


<dt id="arg-estimate-tree-cbh">estimate_tree_cbh<a class="anchor" aria-label="anchor" href="#arg-estimate-tree-cbh"></a></dt>
<dd><p>logical. Should tree DBH be estimated? See <code><a href="trees_cbh.html">trees_cbh()</a></code>.
Make sure to set <code>cbh_estimate_missing_cbh = TRUE</code> if you want to obtain CBH values for cases when CBH cannot be extracted from the point cloud.</p></dd>


<dt id="arg-cbh-tree-sample-n-cbh-tree-sample-prop">cbh_tree_sample_n, cbh_tree_sample_prop<a class="anchor" aria-label="anchor" href="#arg-cbh-tree-sample-n-cbh-tree-sample-prop"></a></dt>
<dd><p>numeric. Provide either <code>tree_sample_n</code>, the number of trees, or <code>tree_sample_prop</code>, the
proportion of the trees to attempt to extract a CBH from the point cloud for.
If neither are supplied, <code>tree_sample_n = 333</code> will be used. If both are supplied, <code>tree_sample_n</code> will be used.
Increasing <code>tree_sample_prop</code> toward one (1) will increase the processing time, perhaps significantly depending on the number of trees in the <code>trees_poly</code> data.
The maximum number of trees to extract tree CBH using <code>cloud2trees()</code> is 20,000.
Try <code><a href="trees_cbh.html">trees_cbh()</a></code> with outputs from <code>cloud2trees()</code> if you want to attempt to extract CBH for &gt;20,000 trees.</p></dd>


<dt id="arg-cbh-which-cbh">cbh_which_cbh<a class="anchor" aria-label="anchor" href="#arg-cbh-which-cbh"></a></dt>
<dd><p>character. One of: "lowest"; "highest"; or "max_lad". See Viedma et al. (2024) reference.</p><ul><li><p>"lowest" - Height of the CBH of the segmented tree based on the last distance found in its profile</p></li>
<li><p>"highest" - Height of the CBH of the segmented tree based on the maximum distance found in its profile</p></li>
<li><p>"max_lad" - Height of the CBH of the segmented tree based on the maximum LAD percentage</p></li>
</ul></dd>


<dt id="arg-cbh-estimate-missing-cbh">cbh_estimate_missing_cbh<a class="anchor" aria-label="anchor" href="#arg-cbh-estimate-missing-cbh"></a></dt>
<dd><p>logical. even if the <code>cbh_tree_sample_prop</code> parameter is set to "1", it is not likely that CBH will be extracted successfully from every tree.
Should the missing CBH values be estimated using the tree height and location information based on trees for which CBH is successfully extracted?</p></dd>


<dt id="arg-cbh-min-vhp-n">cbh_min_vhp_n<a class="anchor" aria-label="anchor" href="#arg-cbh-min-vhp-n"></a></dt>
<dd><p>numeric. the minimum number of vertical height profiles (VHPs) needed to estimate a CBH.</p></dd>


<dt id="arg-cbh-voxel-grain-size-m">cbh_voxel_grain_size_m<a class="anchor" aria-label="anchor" href="#arg-cbh-voxel-grain-size-m"></a></dt>
<dd><p>numeric. horizontal resolution (suggested 1 meter for lad profiles and 10 meters for LAI maps). See <code>grain.size</code> in <code><a href="https://rdrr.io/pkg/leafR/man/lad.voxels.html" class="external-link">leafR::lad.voxels()</a></code></p></dd>


<dt id="arg-cbh-dist-btwn-bins-m">cbh_dist_btwn_bins_m<a class="anchor" aria-label="anchor" href="#arg-cbh-dist-btwn-bins-m"></a></dt>
<dd><p>numeric. value for the actual height bin step (in meters). See <code>step</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_gaps_fbhs.html" class="external-link">LadderFuelsR::get_gaps_fbhs()</a></code></p></dd>


<dt id="arg-cbh-min-fuel-layer-ht-m">cbh_min_fuel_layer_ht_m<a class="anchor" aria-label="anchor" href="#arg-cbh-min-fuel-layer-ht-m"></a></dt>
<dd><p>numeric. value for the actual minimum base height (in meters). See <code>min_height</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_gaps_fbhs.html" class="external-link">LadderFuelsR::get_gaps_fbhs()</a></code></p></dd>


<dt id="arg-cbh-lad-pct-gap">cbh_lad_pct_gap<a class="anchor" aria-label="anchor" href="#arg-cbh-lad-pct-gap"></a></dt>
<dd><p>numeric. value of the percentile threshold used to identify gaps (default percentile 25th). See <code>perc_gap</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_gaps_fbhs.html" class="external-link">LadderFuelsR::get_gaps_fbhs()</a></code></p></dd>


<dt id="arg-cbh-lad-pct-base">cbh_lad_pct_base<a class="anchor" aria-label="anchor" href="#arg-cbh-lad-pct-base"></a></dt>
<dd><p>numeric. value of the percentile threshold used to identify fuels layers base height (default percentile 25th). See <code>perc_base</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_gaps_fbhs.html" class="external-link">LadderFuelsR::get_gaps_fbhs()</a></code></p></dd>


<dt id="arg-cbh-num-jump-steps">cbh_num_jump_steps<a class="anchor" aria-label="anchor" href="#arg-cbh-num-jump-steps"></a></dt>
<dd><p>numeric. value for the number of height bin steps that can be jumped to reshape fuels layers. See <code>number_steps</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_real_fbh.html" class="external-link">LadderFuelsR::get_real_fbh()</a></code></p></dd>


<dt id="arg-cbh-min-lad-pct">cbh_min_lad_pct<a class="anchor" aria-label="anchor" href="#arg-cbh-min-lad-pct"></a></dt>
<dd><p>numeric. value for the minimum required LAD percentage in a fuel layer. See <code>threshold</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_layers_lad.html" class="external-link">LadderFuelsR::get_layers_lad()</a></code></p></dd>


<dt id="arg-cbh-frst-layer-min-ht-m">cbh_frst_layer_min_ht_m<a class="anchor" aria-label="anchor" href="#arg-cbh-frst-layer-min-ht-m"></a></dt>
<dd><p>numeric. value for the depth height of the first fuel layer. If the first fuel layer has the maximum LAD and its depth is greater than the indicated value, then this fuel layer is considered as the CBH of the tree. On the contrary, if its depth is &lt;= the value, the CBH with maximum LAD will be the second fuel layer, although it has not the maximum LAD. See <code>hdepth1_height</code> in <code><a href="https://rdrr.io/pkg/LadderFuelsR/man/get_cbh_metrics.html" class="external-link">LadderFuelsR::get_cbh_metrics()</a></code></p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>logical. Should the output files in the <code>point_cloud_processing_delivery</code> directory from previous iterations be deleted?</p></dd>


<dt id="arg-dbh-model">dbh_model<a class="anchor" aria-label="anchor" href="#arg-dbh-model"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Use the <code>dbh_model_regional</code> or <code>dbh_model_local</code> argument instead.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns the goods.
Exports files of the goods to new folders "point_cloud_processing_delivery" and "point_cloud_processing_temp" in the
<code>output_dir</code> defined by the user in the function call.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span> <span class="co"># test las file but this could also be a directory path with &gt;1 .las|.laz files</span></span></span>
<span class="r-in"><span> <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"MixedConifer.laz"</span>, package<span class="op">=</span><span class="st">"lidR"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># run it</span></span></span>
<span class="r-in"><span> <span class="va">cloud2trees_ans</span> <span class="op">&lt;-</span> <span class="fu">cloud2trees</span><span class="fu">::</span><span class="fu">cloud2trees</span><span class="op">(</span>output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, input_las_dir <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># what is it?</span></span></span>
<span class="r-in"><span> <span class="va">cloud2trees_ans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># there's a DTM</span></span></span>
<span class="r-in"><span> <span class="va">cloud2trees_ans</span><span class="op">$</span><span class="va">dtm_rast</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># there's a CHM</span></span></span>
<span class="r-in"><span> <span class="va">cloud2trees_ans</span><span class="op">$</span><span class="va">chm_rast</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># there are tree crowns</span></span></span>
<span class="r-in"><span> <span class="va">cloud2trees_ans</span><span class="op">$</span><span class="va">crowns_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">cloud2trees_ans</span><span class="op">$</span><span class="va">crowns_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">tree_height_m</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># there are tree top points</span></span></span>
<span class="r-in"><span> <span class="va">cloud2trees_ans</span><span class="op">$</span><span class="va">treetops_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">cloud2trees_ans</span><span class="op">$</span><span class="va">treetops_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">tree_height_m</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by George Woolsey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

